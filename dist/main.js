!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.DownZip=r():e.DownZip=r()}(window,(function(){return function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=0)}([function(e,r,n){"use strict";n.r(r);var t=function(){function e(){var r=Error.call(this,"ServiceWorker is not supported.");return Object.setPrototypeOf(r,e.prototype),r}return e.prototype=Object.create(Error.prototype),e}(),o="/downzip-sw.js";function i(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(e,r,n,t,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?r(u):Promise.resolve(u).then(t,o)}function c(e){return function(){var r=this,n=arguments;return new Promise((function(t,o){var i=e.apply(r,n);function c(e){a(i,t,o,c,u,"next",e)}function u(e){a(i,t,o,c,u,"throw",e)}c(void 0)}))}}function u(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var s=new function e(r){var n=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"error",(function(e){console.error("[".concat(n.name,"] ").concat(e))})),i(this,"log",(function(e){console.log("[".concat(n.name,"] ").concat(e))})),this.name=r}("DownZip-Main"),f="downzip",p=5e3,l=function(){function e(r){var n,i=this,a=r.scope;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.worker=null,this.scope=a=a||"./".concat(f,"/"),(n={scope:a},"serviceWorker"in navigator?navigator.serviceWorker.register(o,n):Promise.reject(new t)).then((function(e){s.log("[DownZip] Service worker registered successfully:",e),i.worker=e.installing||e.active})).catch((function(e){s.error("[DownZip] Service workers not loaded:",e)})),setInterval(c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.sendMessage("TICK");case 1:case"end":return e.stop()}}),e)}))),p)}var r,n,i,a;return r=e,(n=[{key:"sendMessage",value:function(e,r,n){this.worker&&this.worker.postMessage({command:e,data:r},n?[n]:void 0)}},{key:"downzip",value:(a=c(regeneratorRuntime.mark((function e(r,n,t){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.worker){e.next=3;break}return s.error("[DownZip] No service worker registered!"),e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e,i){var a=new MessageChannel;a.port1.addEventListener("message",(function(){return e("".concat(o.scope,"download-").concat(r))})),a.port1.start(),o.sendMessage("INITIALIZE",{id:r,files:t,name:n},a.port2),setTimeout(i,5e3)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return a.apply(this,arguments)})}])&&u(r.prototype,n),i&&u(r,i),e}();r.default=l}])}));